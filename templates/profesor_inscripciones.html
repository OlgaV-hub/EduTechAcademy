{% extends "base.html" %}

{% block content %}
<div class="row g-4">
  <div class="col-12 col-md-3">
    {# подсветим в сайдбаре "Cursos" как активный #}
    {% set active = 'cursos' %}
    {% include "_sidebar.html" %}
  </div>

  <div class="col-12 col-md-9">
    <h2 class="mb-3">
      Inscripciones del curso: {{ curso.nombre }}
    </h2>

    {% if inscripciones %}
      <div class="table-responsive">
        <table class="table table-striped align-middle">
          <thead>
            <tr>
              <th>Estudiante</th>
              <th>Estado / Nota</th>
              <th>Fecha inscripción</th>
            </tr>
          </thead>
          <tbody>
            {% for insc, alumno in inscripciones %}
              <tr>
                <td>{{ alumno.username }}</td>
                <td>
                  <form method="post"
                        class="row row-cols-lg-auto g-2 align-items-center">

                    <input type="hidden" name="enrollment_id" value="{{ insc.id }}">

                    <div class="col-12">
                      <select name="status"
                              class="form-select form-select-sm">
                        <option value="pendiente"
                          {% if insc.status == 'pendiente' %}selected{% endif %}>
                          Pendiente
                        </option>
                        <option value="entregado"
                          {% if insc.status == 'entregado' %}selected{% endif %}>
                          Entregado
                        </option>
                        <option value="vencido"
                          {% if insc.status == 'vencido' %}selected{% endif %}>
                          Vencido
                        </option>
                      </select>
                    </div>

                    <div class="col-12">
                      <input type="number"
                             name="nota"
                             step="0.1" min="0" max="10"
                             class="form-control form-control-sm"
                             value="{% if insc.nota is not none %}{{ insc.nota }}{% endif %}">
                    </div>

                    <div class="col-12">
                      <button type="submit"
                              class="btn btn-sm btn-primary">
                        Guardar
                      </button>
                    </div>
                  </form>
                </td>
                <td>
                  {% if insc.created_at %}
                    {{ insc.created_at.strftime('%Y-%m-%d') }}
                  {% else %}
                    -
                  {% endif %}
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <p>No hay inscripciones para este curso.</p>
    {% endif %}

        <a href="{{ url_for('courses.listar_cursos') }}"
        class="btn btn-outline-secondary mt-3">
        ← Volver a Mis cursos
        </a>
  </div>
</div>
{% endblock %}