{# templates/form_curso.html #}
{% extends "base.html" %}

{% block title %}{{ 'Editar curso' if curso else 'Nuevo curso' }}{% endblock %}

{% block content %}
<div class="row g-4">

  <div class="col-12 col-md-3">
    {# подсветим в сайдбаре пункт "Agregar curso" #}
    {% set active = 'agregar_curso' %}
    {% include "_sidebar.html" %}
  </div>

  <div class="col-12 col-md-9">
    <h1 class="mb-4">
      {{ 'Editar curso' if curso else 'Crear nuevo curso' }}
    </h1>

    <form action="{{ url_for('courses.editar_curso', course_id=curso.id) if curso else url_for('courses.agregar_curso') }}"
          method="post"
          enctype="multipart/form-data">

      <div class="mb-3">
        <label for="nombre" class="form-label">Nombre</label>
        <input type="text"
               class="form-control"
               id="nombre"
               name="nombre"
               value="{{ curso.nombre if curso else '' }}"
               required>
      </div>

      <div class="mb-3">
        <label for="descripcion" class="form-label">Descripción</label>
        <textarea class="form-control"
                  id="descripcion"
                  name="descripcion"
                  rows="3">{{ curso.descripcion if curso else '' }}</textarea>
      </div>

      <div class="mb-3">
        <label for="precio" class="form-label">Precio (USD)</label>
        <input type="number"
               step="0.01"
               class="form-control"
               id="precio"
               name="precio"
               value="{{ curso.precio if curso else '' }}">
      </div>

      <div class="mb-3">
        <label for="imagen" class="form-label">Imagen del curso (opcional)</label>
        <input class="form-control"
               type="file"
               id="imagen"
               name="imagen"
               accept="image/*">
      </div>

      {% if curso and curso.image_key %}
        <div class="mb-3">
          <p>Imagen actual:</p>
          <img src="{{ url_publica(curso.image_key) }}"
               alt="Imagen del curso"
               class="img-thumbnail"
               style="max-width: 300px;">
        </div>
      {% endif %}

      <button type="submit" class="btn btn-primary">
        {{ 'Guardar cambios' if curso else 'Crear curso' }}
      </button>

      <a href="{{ url_for('courses.listar_cursos') }}"
         class="btn btn-secondary ms-2">
        Cancelar
      </a>
    </form>
  </div>
</div>
{% endblock %}